# å¤–éƒ¨è®¾å¤‡è®¿é—®RAG APIæœåŠ¡é…ç½®æŒ‡å—

## ğŸ“‹ æ¦‚è¿°
æœ¬æŒ‡å—å¸®åŠ©ä½ é…ç½®RAG APIæœåŠ¡ï¼Œä½¿å…¶ä»–è®¾å¤‡å¯ä»¥é€šè¿‡ç½‘ç»œè®¿é—®ã€‚

## ğŸ› ï¸ æœåŠ¡å™¨ç«¯é…ç½® (æä¾›æœåŠ¡çš„ç”µè„‘)

### 1. å¯åŠ¨APIæœåŠ¡
```bash
# åœ¨ä½ çš„ç”µè„‘ä¸Šå¯åŠ¨æœåŠ¡
.venv/Scripts/python.exe api_service.py
```

æœåŠ¡å¯åŠ¨åä¼šæ˜¾ç¤ºç±»ä¼¼ä¿¡æ¯ï¼š
```
ğŸš€ å¯åŠ¨å¾®ä¿¡èŠå¤©è®°å½•APIæœåŠ¡å™¨...
============================================================
ğŸ  æœ¬åœ°è®¿é—®: http://localhost:8000
ğŸŒ å±€åŸŸç½‘è®¿é—®: http://192.168.1.100:8000
ğŸ“– APIæ–‡æ¡£: http://192.168.1.100:8000/docs
============================================================
ğŸ“‹ å…¶ä»–è®¾å¤‡è®¿é—®æ­¥éª¤:
1. ç¡®ä¿è®¾å¤‡åœ¨åŒä¸€å±€åŸŸç½‘
2. è®¿é—®åœ°å€: http://192.168.1.100:8000
3. å¦‚è¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
============================================================
```

### 2. é˜²ç«å¢™é…ç½®

#### Windowsé˜²ç«å¢™:
1. æ‰“å¼€ "Windows Defender é˜²ç«å¢™"
2. ç‚¹å‡» "å…è®¸åº”ç”¨æˆ–åŠŸèƒ½é€šè¿‡ Windows Defender é˜²ç«å¢™"
3. ç‚¹å‡» "æ›´æ”¹è®¾ç½®" â†’ "å…è®¸å…¶ä»–åº”ç”¨"
4. æ‰¾åˆ°Pythonæˆ–æ·»åŠ ç«¯å£8000çš„å…¥ç«™è§„åˆ™

#### æˆ–è€…ä¸´æ—¶å…³é—­é˜²ç«å¢™è¿›è¡Œæµ‹è¯•:
```powershell
# ç®¡ç†å‘˜æƒé™è¿è¡Œ
netsh advfirewall set allprofiles state off
# æµ‹è¯•å®Œæˆåé‡æ–°å¼€å¯
netsh advfirewall set allprofiles state on
```

### 3. è·å–æœ¬æœºIPåœ°å€
```bash
# Windows
ipconfig

# æŸ¥æ‰¾ç±»ä¼¼ 192.168.x.x æˆ– 10.x.x.x çš„åœ°å€
```

## ğŸ’» å®¢æˆ·ç«¯é…ç½® (è®¿é—®æœåŠ¡çš„ç”µè„‘)

### 1. å®‰è£…ä¾èµ–
```bash
pip install requests
```

### 2. ä½¿ç”¨å¤–éƒ¨å®¢æˆ·ç«¯
å°† `external_client.py` å¤åˆ¶åˆ°å®¢æˆ·ç«¯ç”µè„‘ï¼Œç„¶åè¿è¡Œï¼š
```bash
python external_client.py
```

### 3. ç®€å•æµ‹è¯•è¿æ¥
```python
import requests

# æ›¿æ¢ä¸ºæœåŠ¡å™¨å®é™…IP
server_ip = "192.168.1.100"
response = requests.get(f"http://{server_ip}:8000/")
print(response.json())
```

## ğŸŒ APIä½¿ç”¨ç¤ºä¾‹

### åŸºæœ¬æŸ¥è¯¢
```python
import requests

server_url = "http://192.168.1.100:8000"

# æŸ¥è¯¢èŠå¤©è®°å½•
response = requests.post(
    f"{server_url}/query_simple",
    params={
        "question": "å¼ å®å“²è¯´äº†ä»€ä¹ˆï¼Ÿ",
        "max_results": 5
    }
)

data = response.json()
print(f"æ‰¾åˆ° {data['count']} æ¡è®°å½•")
for record in data['records']:
    print(f"å‘é€è€…: {record['sender']}")
    print(f"æ—¶é—´: {record['time']}")
    print(f"å†…å®¹: {record['content']}")
    print("-" * 40)
```

### JavaScript/Web è°ƒç”¨ç¤ºä¾‹
```javascript
async function queryRAG(question) {
    const serverUrl = 'http://192.168.1.100:8000';

    try {
        const response = await fetch(`${serverUrl}/query_simple?question=${encodeURIComponent(question)}&max_results=5`, {
            method: 'POST'
        });

        const data = await response.json();
        console.log(`æ‰¾åˆ° ${data.count} æ¡è®°å½•:`, data.records);
        return data;
    } catch (error) {
        console.error('æŸ¥è¯¢å¤±è´¥:', error);
    }
}

// ä½¿ç”¨
queryRAG('å¿—æ„¿æœåŠ¡ç›¸å…³å†…å®¹');
```

## ğŸ”§ å¸¸è§é—®é¢˜æ’æŸ¥

### è¿æ¥å¤±è´¥
1. **æ£€æŸ¥ç½‘ç»œè¿æ¥**
   ```bash
   ping 192.168.1.100  # æ›¿æ¢ä¸ºå®é™…æœåŠ¡å™¨IP
   ```

2. **æ£€æŸ¥ç«¯å£æ˜¯å¦å¼€æ”¾**
   ```bash
   telnet 192.168.1.100 8000
   ```

3. **æ£€æŸ¥æœåŠ¡æ˜¯å¦è¿è¡Œ**
   ```bash
   # åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ
   netstat -an | findstr :8000
   ```

### é˜²ç«å¢™é—®é¢˜
- Windows: æ£€æŸ¥ Windows Defender é˜²ç«å¢™è®¾ç½®
- è·¯ç”±å™¨: ç¡®ä¿è®¾å¤‡åœ¨åŒä¸€å­ç½‘
- ä¼ä¸šç½‘ç»œ: å¯èƒ½éœ€è¦ç®¡ç†å‘˜æƒé™

### ç½‘ç»œç¯å¢ƒ
- **åŒä¸€å±€åŸŸç½‘**: è®¾å¤‡å¿…é¡»è¿æ¥åˆ°åŒä¸€WiFiæˆ–ç½‘ç»œ
- **å…¬ç½‘è®¿é—®**: éœ€è¦é…ç½®ç«¯å£è½¬å‘ï¼ˆä¸æ¨èï¼Œå®‰å…¨é£é™©ï¼‰

## ğŸ“Š APIç«¯ç‚¹è¯´æ˜

| ç«¯ç‚¹ | æ–¹æ³• | æè¿° |
|------|------|------|
| `/` | GET | æœåŠ¡ä¿¡æ¯ |
| `/health` | GET | å¥åº·æ£€æŸ¥ |
| `/stats` | GET | æ•°æ®ç»Ÿè®¡ |
| `/query` | POST | å®Œæ•´æŸ¥è¯¢ |
| `/query_simple` | POST | ç®€åŒ–æŸ¥è¯¢ |
| `/docs` | GET | APIæ–‡æ¡£ |

## ğŸ”’ å®‰å…¨æ³¨æ„äº‹é¡¹

1. **ä»…åœ¨ä¿¡ä»»çš„ç½‘ç»œä½¿ç”¨**
2. **ä¸è¦æš´éœ²åˆ°å…¬ç½‘**
3. **è€ƒè™‘æ·»åŠ è®¤è¯æœºåˆ¶**
4. **ç”Ÿäº§ç¯å¢ƒè¯·é™åˆ¶CORSåŸŸå**

## ğŸ“ æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼š
1. æ£€æŸ¥æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯çš„IPåœ°å€æ˜¯å¦æ­£ç¡®
2. ç¡®è®¤é˜²ç«å¢™è®¾ç½®
3. éªŒè¯ç½‘ç»œè¿é€šæ€§
4. æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—è¾“å‡º